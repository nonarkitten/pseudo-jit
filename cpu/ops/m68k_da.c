#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

typedef struct {
	uint16_t match, equal;
    const char* op;
} opcode_t;

const char* cc[] = { 
    "T ", "F ", "HI", "LS",
    "CC", "CS", "NE", "EQ",
    "VC", "VS", "PL", "MI",
    "GE", "LT", "GT", "LE",
};

const opcode_t opcodes[] = {
    { 0xFFB8, 0x0000, "ORI.@ #Immd,$E" },
    { 0xFFB0, 0x0010, "ORI.@ #Immd,$E" },
    { 0xFFB0, 0x0020, "ORI.@ #Immd,$E" },
    { 0xFFB8, 0x0030, "ORI.@ #Immd,$E" },
    { 0xFFBE, 0x0038, "ORI.@ #Immd,$E" },
    { 0xFFFF, 0x003C, "ORI to CCR" },
    { 0xFFFF, 0x007C, "ORI to SR" },
    { 0xFFF8, 0x0080, "ORI.L #Immd,$E" },
    { 0xFFF0, 0x0090, "ORI.L #Immd,$E" },
    { 0xFFF0, 0x00A0, "ORI.L #Immd,$E" },
    { 0xFFF8, 0x00B0, "ORI.L #Immd,$E" },
    { 0xFFFE, 0x00B8, "ORI.L #Immd,$E" },
    { 0xFFB8, 0x0200, "ANDI.@ #Immd,$E" },
    { 0xFFB0, 0x0210, "ANDI.@ #Immd,$E" },
    { 0xFFB0, 0x0220, "ANDI.@ #Immd,$E" },
    { 0xFFB8, 0x0230, "ANDI.@ #Immd,$E" },
    { 0xFFBE, 0x0238, "ANDI.@ #Immd,$E" },
    { 0xFFFF, 0x023C, "ANDI to CCR" },
    { 0xFFFF, 0x027C, "ANDI to SR" },
    { 0xFFF8, 0x0280, "ANDI.L #Immd,$E" },
    { 0xFFF0, 0x0290, "ANDI.L #Immd,$E" },
    { 0xFFF0, 0x02A0, "ANDI.L #Immd,$E" },
    { 0xFFF8, 0x02B0, "ANDI.L #Immd,$E" },
    { 0xFFFE, 0x02B8, "ANDI.L #Immd,$E" },
    { 0xFFB8, 0x0400, "SUBI.@ #Immd,$E" },
    { 0xFFB0, 0x0410, "SUBI.@ #Immd,$E" },
    { 0xFFB0, 0x0420, "SUBI.@ #Immd,$E" },
    { 0xFFB8, 0x0430, "SUBI.@ #Immd,$E" },
    { 0xFFBE, 0x0438, "SUBI.@ #Immd,$E" },
    { 0xFFF8, 0x0480, "SUBI.L #Immd,$E" },
    { 0xFFF0, 0x0490, "SUBI.L #Immd,$E" },
    { 0xFFF0, 0x04A0, "SUBI.L #Immd,$E" },
    { 0xFFF8, 0x04B0, "SUBI.L #Immd,$E" },
    { 0xFFFE, 0x04B8, "SUBI.L #Immd,$E" },
    { 0xFFB8, 0x0600, "ADDI.@ #Immd,$E" },
    { 0xFFB0, 0x0610, "ADDI.@ #Immd,$E" },
    { 0xFFB0, 0x0620, "ADDI.@ #Immd,$E" },
    { 0xFFB8, 0x0630, "ADDI.@ #Immd,$E" },
    { 0xFFBE, 0x0638, "ADDI.@ #Immd,$E" },
    { 0xFFF8, 0x0680, "ADDI.L #Immd,$E" },
    { 0xFFF0, 0x0690, "ADDI.L #Immd,$E" },
    { 0xFFF0, 0x06A0, "ADDI.L #Immd,$E" },
    { 0xFFF8, 0x06B0, "ADDI.L #Immd,$E" },
    { 0xFFFE, 0x06B8, "ADDI.L #Immd,$E" },
    { 0xFFB8, 0x0A00, "EORI.@ #Immd,$E" },
    { 0xFFB0, 0x0A10, "EORI.@ #Immd,$E" },
    { 0xFFB0, 0x0A20, "EORI.@ #Immd,$E" },
    { 0xFFB8, 0x0A30, "EORI.@ #Immd,$E" },
    { 0xFFBE, 0x0A38, "EORI.@ #Immd,$E" },
    { 0xFFFF, 0x0A3C, "EORI to CCR" },
    { 0xFFFF, 0x0A7C, "EORI to SR" },
    { 0xFFF8, 0x0A80, "EORI.L #Immd,$E" },
    { 0xFFF0, 0x0A90, "EORI.L #Immd,$E" },
    { 0xFFF0, 0x0AA0, "EORI.L #Immd,$E" },
    { 0xFFF8, 0x0AB0, "EORI.L #Immd,$E" },
    { 0xFFFE, 0x0AB8, "EORI.L #Immd,$E" },
    { 0xFFB8, 0x0C00, "CMPI.@ #Immd,$E" },
    { 0xFFB0, 0x0C10, "CMPI.@ #Immd,$E" },
    { 0xFFB0, 0x0C20, "CMPI.@ #Immd,$E" },
    { 0xFFB8, 0x0C30, "CMPI.@ #Immd,$E" },
    { 0xFFBE, 0x0C38, "CMPI.@ #Immd,$E" },
    { 0xFFF8, 0x0C80, "CMPI.L #Immd,$E" },
    { 0xFFF0, 0x0C90, "CMPI.L #Immd,$E" },
    { 0xFFF0, 0x0CA0, "CMPI.L #Immd,$E" },
    { 0xFFF8, 0x0CB0, "CMPI.L #Immd,$E" },
    { 0xFFFE, 0x0CB8, "CMPI.L #Immd,$E" },
    { 0xFFF8, 0x0800, "BCLR #Immd,$E" },
    { 0xFFF0, 0x0810, "BCLR #Immd,$E" },
    { 0xFFF0, 0x0820, "BCLR #Immd,$E" },
    { 0xFFF8, 0x0830, "BCLR #Immd,$E" },
    { 0xFFFE, 0x0838, "BCLR #Immd,$E" },
    { 0xF1F8, 0x0100, "BCLR D$N,$E" },
    { 0xF1F0, 0x0110, "BCLR D$N,$E" },
    { 0xF1F0, 0x0120, "BCLR D$N,$E" },
    { 0xF1F8, 0x0130, "BCLR D$N,$E" },
    { 0xF1FE, 0x0138, "BCLR D$N,$E" },
    { 0xFFF8, 0x0840, "BCHG #Immd,$E" },
    { 0xFFF0, 0x0850, "BCHG #Immd,$E" },
    { 0xFFF0, 0x0860, "BCHG #Immd,$E" },
    { 0xFFF8, 0x0870, "BCHG #Immd,$E" },
    { 0xFFFE, 0x0878, "BCHG #Immd,$E" },
    { 0xF1F8, 0x0140, "BCHG D$N,$E" },
    { 0xF1F0, 0x0150, "BCHG D$N,$E" },
    { 0xF1F0, 0x0160, "BCHG D$N,$E" },
    { 0xF1F8, 0x0170, "BCHG D$N,$E" },
    { 0xF1FE, 0x0178, "BCHG D$N,$E" },
    { 0xFFF8, 0x0880, "BCLR #Immd,$E" },
    { 0xFFF0, 0x0890, "BCLR #Immd,$E" },
    { 0xFFF0, 0x08A0, "BCLR #Immd,$E" },
    { 0xFFF8, 0x08B0, "BCLR #Immd,$E" },
    { 0xFFFE, 0x08B8, "BCLR #Immd,$E" },
    { 0xF1F8, 0x0180, "BCLR D$N,$E" },
    { 0xF1F0, 0x0190, "BCLR D$N,$E" },
    { 0xF1F0, 0x01A0, "BCLR D$N,$E" },
    { 0xF1F8, 0x01B0, "BCLR D$N,$E" },
    { 0xF1FE, 0x01B8, "BCLR D$N,$E" },
    { 0xFFF8, 0x08C0, "BSET #Immd,$E" },
    { 0xFFF0, 0x08D0, "BSET #Immd,$E" },
    { 0xFFF0, 0x08E0, "BSET #Immd,$E" },
    { 0xFFF8, 0x08F0, "BSET #Immd,$E" },
    { 0xFFFE, 0x08F8, "BSET #Immd,$E" },
    { 0xF1F8, 0x01C0, "BSET D$N,$E" },
    { 0xF1F0, 0x01D0, "BSET D$N,$E" },
    { 0xF1F0, 0x01E0, "BSET D$N,$E" },
    { 0xF1F8, 0x01F0, "BSET D$N,$E" },
    { 0xF1FE, 0x01F8, "BSET D$N,$E" },
    { 0xF1B8, 0x0108, "MOVEP $E,D$N" },
    { 0xF1B8, 0x0188, "MOVEP D$N,$E" },
    { 0xF1F8, 0x1000, "MOVE.B $E,$E" },
    { 0xF1F0, 0x1010, "MOVE.B $E,$E" },
    { 0xF1F0, 0x1020, "MOVE.B $E,$E" },
    { 0xF1F8, 0x1030, "MOVE.B $E,$E" },
    { 0xF1FC, 0x1038, "MOVE.B $E,$E" },
    { 0xF1FF, 0x103C, "MOVE.B $E,$E" },
    { 0xF1B8, 0x1080, "MOVE.B $E,$E" },
    { 0xF1B0, 0x1090, "MOVE.B $E,$E" },
    { 0xF1B0, 0x10A0, "MOVE.B $E,$E" },
    { 0xF1B8, 0x10B0, "MOVE.B $E,$E" },
    { 0xF1BC, 0x10B8, "MOVE.B $E,$E" },
    { 0xF1BF, 0x10BC, "MOVE.B $E,$E" },
    { 0xF1B8, 0x1100, "MOVE.B $E,$E" },
    { 0xF1B0, 0x1110, "MOVE.B $E,$E" },
    { 0xF1B0, 0x1120, "MOVE.B $E,$E" },
    { 0xF1B8, 0x1130, "MOVE.B $E,$E" },
    { 0xF1BC, 0x1138, "MOVE.B $E,$E" },
    { 0xF1BF, 0x113C, "MOVE.B $E,$E" },
    { 0xF1F8, 0x1180, "MOVE.B $E,$E" },
    { 0xF1F0, 0x1190, "MOVE.B $E,$E" },
    { 0xF1F0, 0x11A0, "MOVE.B $E,$E" },
    { 0xF1F8, 0x11B0, "MOVE.B $E,$E" },
    { 0xF1FC, 0x11B8, "MOVE.B $E,$E" },
    { 0xF1FF, 0x11BC, "MOVE.B $E,$E" },
    { 0xFDF8, 0x11C0, "MOVE.B $E,$E" },
    { 0xFDF0, 0x11D0, "MOVE.B $E,$E" },
    { 0xFDF0, 0x11E0, "MOVE.B $E,$E" },
    { 0xFDF8, 0x11F0, "MOVE.B $E,$E" },
    { 0xFDFC, 0x11F8, "MOVE.B $E,$E" },
    { 0xFDFF, 0x11FC, "MOVE.B $E,$E" },
    { 0xF1E0, 0x2000, "MOVE.L $E,$E" },
    { 0xF1F0, 0x2020, "MOVE.L $E,$E" },
    { 0xF1F8, 0x2030, "MOVE.L $E,$E" },
    { 0xF1FC, 0x2038, "MOVE.L $E,$E" },
    { 0xF1FF, 0x203C, "MOVE.L $E,$E" },
    { 0xF1E0, 0x2040, "MOVEA.L $E,$E" },
    { 0xF1F0, 0x2060, "MOVEA.L $E,$E" },
    { 0xF1F8, 0x2070, "MOVEA.L $E,$E" },
    { 0xF1FC, 0x2078, "MOVEA.L $E,$E" },
    { 0xF1FF, 0x207C, "MOVEA.L $E,$E" },
    { 0xF1A0, 0x2080, "MOVE.L $E,$E" },
    { 0xF1B0, 0x20A0, "MOVE.L $E,$E" },
    { 0xF1B8, 0x20B0, "MOVE.L $E,$E" },
    { 0xF1BC, 0x20B8, "MOVE.L $E,$E" },
    { 0xF1BF, 0x20BC, "MOVE.L $E,$E" },
    { 0xF1A0, 0x2100, "MOVE.L $E,$E" },
    { 0xF1B0, 0x2120, "MOVE.L $E,$E" },
    { 0xF1B8, 0x2130, "MOVE.L $E,$E" },
    { 0xF1BC, 0x2138, "MOVE.L $E,$E" },
    { 0xF1BF, 0x213C, "MOVE.L $E,$E" },
    { 0xF1E0, 0x2180, "MOVE.L $E,$E" },
    { 0xF1F0, 0x21A0, "MOVE.L $E,$E" },
    { 0xF1F8, 0x21B0, "MOVE.L $E,$E" },
    { 0xF1FC, 0x21B8, "MOVE.L $E,$E" },
    { 0xF1FF, 0x21BC, "MOVE.L $E,$E" },
    { 0xFDE0, 0x21C0, "MOVE.L $E,$E" },
    { 0xFDF0, 0x21E0, "MOVE.L $E,$E" },
    { 0xFDF8, 0x21F0, "MOVE.L $E,$E" },
    { 0xFDFC, 0x21F8, "MOVE.L $E,$E" },
    { 0xFDFF, 0x21FC, "MOVE.L $E,$E" },
    { 0xF1E0, 0x3000, "MOVE.W $E,$E" },
    { 0xF1F0, 0x3020, "MOVE.W $E,$E" },
    { 0xF1F8, 0x3030, "MOVE.W $E,$E" },
    { 0xF1FC, 0x3038, "MOVE.W $E,$E" },
    { 0xF1FF, 0x303C, "MOVE.W $E,$E" },
    { 0xF1E0, 0x3040, "MOVEA.W $E,$E" },
    { 0xF1F0, 0x3060, "MOVEA.W $E,$E" },
    { 0xF1F8, 0x3070, "MOVEA.W $E,$E" },
    { 0xF1FC, 0x3078, "MOVEA.W $E,$E" },
    { 0xF1FF, 0x307C, "MOVEA.W $E,$E" },
    { 0xF1A0, 0x3080, "MOVE.W $E,$E" },
    { 0xF1B0, 0x30A0, "MOVE.W $E,$E" },
    { 0xF1B8, 0x30B0, "MOVE.W $E,$E" },
    { 0xF1BC, 0x30B8, "MOVE.W $E,$E" },
    { 0xF1BF, 0x30BC, "MOVE.W $E,$E" },
    { 0xF1A0, 0x3100, "MOVE.W $E,$E" },
    { 0xF1B0, 0x3120, "MOVE.W $E,$E" },
    { 0xF1B8, 0x3130, "MOVE.W $E,$E" },
    { 0xF1BC, 0x3138, "MOVE.W $E,$E" },
    { 0xF1BF, 0x313C, "MOVE.W $E,$E" },
    { 0xF1E0, 0x3180, "MOVE.W $E,$E" },
    { 0xF1F0, 0x31A0, "MOVE.W $E,$E" },
    { 0xF1F8, 0x31B0, "MOVE.W $E,$E" },
    { 0xF1FC, 0x31B8, "MOVE.W $E,$E" },
    { 0xF1FF, 0x31BC, "MOVE.W $E,$E" },
    { 0xFDE0, 0x31C0, "MOVE.W $E,$E" },
    { 0xFDF0, 0x31E0, "MOVE.W $E,$E" },
    { 0xFDF8, 0x31F0, "MOVE.W $E,$E" },
    { 0xFDFC, 0x31F8, "MOVE.W $E,$E" },
    { 0xFDFF, 0x31FC, "MOVE.W $E,$E" },
    { 0xFFF8, 0x40C0, "MOVE SR,$E" },
    { 0xFFF0, 0x40D0, "MOVE SR,$E" },
    { 0xFFF0, 0x40E0, "MOVE SR,$E" },
    { 0xFFF8, 0x40F0, "MOVE SR,$E" },
    { 0xFFFE, 0x40F8, "MOVE SR,$E" },
    { 0xFFF8, 0x44C0, "MOVE $E,CCR" },
    { 0xFFF0, 0x44D0, "MOVE $E,CCR" },
    { 0xFFF0, 0x44E0, "MOVE $E,CCR" },
    { 0xFFF8, 0x44F0, "MOVE $E,CCR" },
    { 0xFFFC, 0x44F8, "MOVE $E,CCR" },
    { 0xFFFF, 0x44FC, "MOVE $E,CCR" },
    { 0xFFF8, 0x46C0, "MOVE $E,SR" },
    { 0xFFF0, 0x46D0, "MOVE $E,SR" },
    { 0xFFF0, 0x46E0, "MOVE $E,SR" },
    { 0xFFF8, 0x46F0, "MOVE $E,SR" },
    { 0xFFFC, 0x46F8, "MOVE $E,SR" },
    { 0xFFFF, 0x46FC, "MOVE $E,SR" },
    { 0xFFB8, 0x4000, "NEGX.@ $E" },
    { 0xFFB0, 0x4010, "NEGX.@ $E" },
    { 0xFFB0, 0x4020, "NEGX.@ $E" },
    { 0xFFB8, 0x4030, "NEGX.@ $E" },
    { 0xFFBE, 0x4038, "NEGX.@ $E" },
    { 0xFFF8, 0x4080, "NEGX.L $E" },
    { 0xFFF0, 0x4090, "NEGX.L $E" },
    { 0xFFF0, 0x40A0, "NEGX.L $E" },
    { 0xFFF8, 0x40B0, "NEGX.L $E" },
    { 0xFFFE, 0x40B8, "NEGX.L $E" },
    { 0xFFB8, 0x4200, "CLR.@ $E" },
    { 0xFFB0, 0x4210, "CLR.@ $E" },
    { 0xFFB0, 0x4220, "CLR.@ $E" },
    { 0xFFB8, 0x4230, "CLR.@ $E" },
    { 0xFFBE, 0x4238, "CLR.@ $E" },
    { 0xFFF8, 0x4280, "CLR.L $E" },
    { 0xFFF0, 0x4290, "CLR.L $E" },
    { 0xFFF0, 0x42A0, "CLR.L $E" },
    { 0xFFF8, 0x42B0, "CLR.L $E" },
    { 0xFFFE, 0x42B8, "CLR.L $E" },
    { 0xFFB8, 0x4400, "NEG.@ $E" },
    { 0xFFB0, 0x4410, "NEG.@ $E" },
    { 0xFFB0, 0x4420, "NEG.@ $E" },
    { 0xFFB8, 0x4430, "NEG.@ $E" },
    { 0xFFBE, 0x4438, "NEG.@ $E" },
    { 0xFFF8, 0x4480, "NEG.L $E" },
    { 0xFFF0, 0x4490, "NEG.L $E" },
    { 0xFFF0, 0x44A0, "NEG.L $E" },
    { 0xFFF8, 0x44B0, "NEG.L $E" },
    { 0xFFFE, 0x44B8, "NEG.L $E" },
    { 0xFFB8, 0x4600, "NOT.@ $E" },
    { 0xFFB0, 0x4610, "NOT.@ $E" },
    { 0xFFB0, 0x4620, "NOT.@ $E" },
    { 0xFFB8, 0x4630, "NOT.@ $E" },
    { 0xFFBE, 0x4638, "NOT.@ $E" },
    { 0xFFF8, 0x4680, "NOT.L $E" },
    { 0xFFF0, 0x4690, "NOT.L $E" },
    { 0xFFF0, 0x46A0, "NOT.L $E" },
    { 0xFFF8, 0x46B0, "NOT.L $E" },
    { 0xFFFE, 0x46B8, "NOT.L $E" },
    { 0xFFF8, 0x4880, "EXT.W $E" },
    { 0xFFF8, 0x48C0, "EXT.L $E" },
    { 0xFFF8, 0x4800, "NBCD $E" },
    { 0xFFF0, 0x4810, "NBCD $E" },
    { 0xFFF0, 0x4820, "NBCD $E" },
    { 0xFFF8, 0x4830, "NBCD $E" },
    { 0xFFFE, 0x4838, "NBCD $E" },
    { 0xFFF8, 0x4840, "SWAP $E " },
    { 0xFFF8, 0x4850, "PEA $E  " },
    { 0xFFF8, 0x4868, "PEA $E  " },
    { 0xFFF8, 0x4870, "PEA $E  " },
    { 0xFFFC, 0x4878, "PEA $E  " },
    { 0xFFFF, 0x4AFC, "ILLEGAL " },
    { 0xFFF8, 0x4AC0, "TAS $E  " },
    { 0xFFF0, 0x4AD0, "TAS $E  " },
    { 0xFFF0, 0x4AE0, "TAS $E  " },
    { 0xFFF8, 0x4AF0, "TAS $E  " },
    { 0xFFFE, 0x4AF8, "TAS $E  " },
    { 0xFFB8, 0x4A00, "TST.@ $E" },
    { 0xFFB0, 0x4A10, "TST.@ $E" },
    { 0xFFB0, 0x4A20, "TST.@ $E" },
    { 0xFFB8, 0x4A30, "TST.@ $E" },
    { 0xFFBE, 0x4A38, "TST.@ $E" },
    { 0xFFF8, 0x4A80, "TST.L $E" },
    { 0xFFF0, 0x4A90, "TST.L $E" },
    { 0xFFF0, 0x4AA0, "TST.L $E" },
    { 0xFFF8, 0x4AB0, "TST.L $E" },
    { 0xFFFE, 0x4AB8, "TST.L $E" },
    { 0xFFF8, 0x4E40, "TRAP #$R" },
    { 0xFFFF, 0x4E48, "TRAP #8 " },
    { 0xFFFF, 0x4E49, "TRAP #9 " },
    { 0xFFFF, 0x4E4A, "TRAP #10" },
    { 0xFFFF, 0x4E4B, "TRAP #11" },
    { 0xFFFF, 0x4E4C, "TRAP #12" },
    { 0xFFFF, 0x4E4D, "TRAP #13" },
    { 0xFFFF, 0x4E4E, "TRAP #14" },
    { 0xFFFF, 0x4E4F, "TRAP #15" },
    { 0xFFF8, 0x4E50, "LINK A$R" },
    { 0xFFF8, 0x4E58, "UNLK A$R" },
    { 0xFFF8, 0x4E60, "MOVE A$R,USP" },
    { 0xFFF8, 0x4E68, "MOVE USP,A$R" },
    { 0xFFFF, 0x4E70, "RESET   " },
    { 0xFFFF, 0x4E71, "NOP     " },
    { 0xFFFF, 0x4E72, "STOP    " },
    { 0xFFFF, 0x4E73, "RTE     " },
    { 0xFFFF, 0x4E75, "RTS     " },
    { 0xFFFF, 0x4E76, "TRAPV   " },
    { 0xFFFF, 0x4E77, "RTR     " },
    { 0xFFF8, 0x4E90, "JSR $E  " },
    { 0xFFF8, 0x4EA8, "JSR $E  " },
    { 0xFFF8, 0x4EB0, "JSR $E  " },
    { 0xFFFC, 0x4EB8, "JSR $E  " },
    { 0xFFF8, 0x4ED0, "JMP $E  " },
    { 0xFFF8, 0x4EE8, "JMP $E  " },
    { 0xFFF8, 0x4EF0, "JMP $E  " },
    { 0xFFFC, 0x4EF8, "JMP $E  " },
    { 0xFFB8, 0x4890, "MOVEM <list>,$E" },
    { 0xFFB0, 0x48A0, "MOVEM <list>,$E" },
    { 0xFFB8, 0x48B0, "MOVEM <list>,$E" },
    { 0xFFBE, 0x48B8, "MOVEM <list>,$E" },
    { 0xFFB0, 0x4C90, "MOVEM $E,<list>" },
    { 0xFFB8, 0x4CA8, "MOVEM $E,<list>" },
    { 0xFFB8, 0x4CB0, "MOVEM $E,<list>" },
    { 0xFFBC, 0x4CB8, "MOVEM $E,<list>" },
    { 0xF1F8, 0x41D0, "LEA $E,A$R" },
    { 0xF1F8, 0x41E8, "LEA $E,A$R" },
    { 0xF1F8, 0x41F0, "LEA $E,A$R" },
    { 0xF1FC, 0x41F8, "LEA $E,A$R" },
    { 0xF1F8, 0x4180, "CHK $E,D$N" },
    { 0xF1F0, 0x4190, "CHK $E,D$N" },
    { 0xF1F0, 0x41A0, "CHK $E,D$N" },
    { 0xF1F8, 0x41B0, "CHK $E,D$N" },
    { 0xF1FE, 0x41B8, "CHK $E,D$N" },
    { 0xF1B8, 0x5000, "ADDQ.@ #$N,$E" },
    { 0xF1B0, 0x5010, "ADDQ.@ #$N,$E" },
    { 0xF1B0, 0x5020, "ADDQ.@ #$N,$E" },
    { 0xF1B8, 0x5030, "ADDQ.@ #$N,$E" },
    { 0xF1BE, 0x5038, "ADDQ.@ #$N,$E" },
    { 0xF1E0, 0x5080, "ADDQ.L #$N,$E" },
    { 0xF1F0, 0x50A0, "ADDQ.L #$N,$E" },
    { 0xF1F8, 0x50B0, "ADDQ.L #$N,$E" },
    { 0xF1FE, 0x50B8, "ADDQ.L #$N,$E" },
    { 0xF1B8, 0x5100, "SUBQ.@ #$N,$E" },
    { 0xF1B0, 0x5110, "SUBQ.@ #$N,$E" },
    { 0xF1B0, 0x5120, "SUBQ.@ #$N,$E" },
    { 0xF1B8, 0x5130, "SUBQ.@ #$N,$E" },
    { 0xF1BE, 0x5138, "SUBQ.@ #$N,$E" },
    { 0xF1E0, 0x5180, "SUBQ.L #$N,$E" },
    { 0xF1F0, 0x51A0, "SUBQ.L #$N,$E" },
    { 0xF1F8, 0x51B0, "SUBQ.L #$N,$E" },
    { 0xF1FE, 0x51B8, "SUBQ.L #$N,$E" },
    { 0xF0F8, 0x50C0, "Scc $E  " },
    { 0xF0F0, 0x50D0, "Scc $E  " },
    { 0xF0F0, 0x50E0, "Scc $E  " },
    { 0xF0F8, 0x50F0, "Scc $E  " },
    { 0xF0FE, 0x50F8, "Scc $E  " },
    { 0xFFF8, 0x51C8, "DBRA D$R,label" },
    { 0xF0F8, 0x50C8, "DBcc D$R,label" },
    { 0xFF00, 0x6000, "BRA label" },
    { 0xFF00, 0x6100, "BSR label" },
    { 0xF800, 0x6800, "Bcc label" },
    { 0xFC00, 0x6400, "Bcc label" },
    { 0xFE00, 0x6200, "Bcc label" },
    { 0xF100, 0x7000, "MOVEQ #Immd,D$N" },
    { 0xF1F8, 0x80C0, "DIVU $E,D$N" },
    { 0xF1F0, 0x80D0, "DIVU $E,D$N" },
    { 0xF1F0, 0x80E0, "DIVU $E,D$N" },
    { 0xF1F8, 0x80F0, "DIVU $E,D$N" },
    { 0xF1FC, 0x80F8, "DIVU $E,D$N" },
    { 0xF1FF, 0x80FC, "DIVU $E,D$N" },
    { 0xF1F8, 0x81C0, "DIVS $E,D$N" },
    { 0xF1F0, 0x81D0, "DIVS $E,D$N" },
    { 0xF1F0, 0x81E0, "DIVS $E,D$N" },
    { 0xF1F8, 0x81F0, "DIVS $E,D$N" },
    { 0xF1FC, 0x81F8, "DIVS $E,D$N" },
    { 0xF1FF, 0x81FC, "DIVS $E,D$N" },
    { 0xF1F8, 0x8100, "SBCD D$R,D$N" },
    { 0xF1F8, 0x8108, "SBCD -(A$R),-(A$N)" },
    { 0xF1B8, 0x8000, "OR.@ $E,D$N" },
    { 0xF1B0, 0x8010, "OR.@ $E,D$N" },
    { 0xF1B0, 0x8020, "OR.@ $E,D$N" },
    { 0xF1B8, 0x8030, "OR.@ $E,D$N" },
    { 0xF1BC, 0x8038, "OR.@ $E,D$N" },
    { 0xF1BF, 0x803C, "OR.@ $E,D$N" },
    { 0xF1F8, 0x8048, "OR.W A$N,$E" },
    { 0xF1B0, 0x8110, "OR.@ D$N,$E" },
    { 0xF1B0, 0x8120, "OR.@ D$N,$E" },
    { 0xF1B8, 0x8130, "OR.@ D$N,$E" },
    { 0xF1BE, 0x8138, "OR.@ D$N,$E" },
    { 0xF1F8, 0x8080, "OR.L $E,D$N" },
    { 0xF1F8, 0x8088, "OR.L $E,D$N" },
    { 0xF1F0, 0x8090, "OR.L $E,D$N" },
    { 0xF1F0, 0x80A0, "OR.L $E,D$N" },
    { 0xF1F8, 0x80B0, "OR.L $E,D$N" },
    { 0xF1FC, 0x80B8, "OR.L $E,D$N" },
    { 0xF1FF, 0x80BC, "OR.L $E,D$N" },
    { 0xF1F0, 0x8190, "OR.L D$N,$E" },
    { 0xF1F0, 0x81A0, "OR.L D$N,$E" },
    { 0xF1F8, 0x81B0, "OR.L D$N,$E" },
    { 0xF1FE, 0x81B8, "OR.L D$N,$E" },
    { 0xF1B8, 0x9000, "SUB.@ $E,D$N" },
    { 0xF1B0, 0x9010, "SUB.@ $E,D$N" },
    { 0xF1B0, 0x9020, "SUB.@ $E,D$N" },
    { 0xF1B8, 0x9030, "SUB.@ $E,D$N" },
    { 0xF1BC, 0x9038, "SUB.@ $E,D$N" },
    { 0xF1BF, 0x903C, "SUB.@ $E,D$N" },
    { 0xF1F8, 0x9048, "SUB.W A$N,$E" },
    { 0xF1B0, 0x9110, "SUB.@ D$N,$E" },
    { 0xF1B0, 0x9120, "SUB.@ D$N,$E" },
    { 0xF1B8, 0x9130, "SUB.@ D$N,$E" },
    { 0xF1BE, 0x9138, "SUB.@ D$N,$E" },
    { 0xF1F8, 0x9080, "SUB.L $E,D$N" },
    { 0xF1F8, 0x9088, "SUB.L $E,D$N" },
    { 0xF1F0, 0x9090, "SUB.L $E,D$N" },
    { 0xF1F0, 0x90A0, "SUB.L $E,D$N" },
    { 0xF1F8, 0x90B0, "SUB.L $E,D$N" },
    { 0xF1FC, 0x90B8, "SUB.L $E,D$N" },
    { 0xF1FF, 0x90BC, "SUB.L $E,D$N" },
    { 0xF1F0, 0x9190, "SUB.L D$N,$E" },
    { 0xF1F0, 0x91A0, "SUB.L D$N,$E" },
    { 0xF1F8, 0x91B0, "SUB.L D$N,$E" },
    { 0xF1FE, 0x91B8, "SUB.L D$N,$E" },
    { 0xF1B8, 0x9100, "SUBX.@ D$R,D$N" },
    { 0xF1B8, 0x9108, "SUBX.@ -(A$R),-(A$N)" },
    { 0xF1F8, 0x9180, "SUBX.L D$R,D$N" },
    { 0xF1F8, 0x9188, "SUBX.L -(A$R),-(A$N)" },
    { 0xF1E0, 0x90C0, "SUBA.W $E,A$N" },
    { 0xF1F0, 0x90E0, "SUBA.W $E,A$N" },
    { 0xF1F8, 0x90F0, "SUBA.W $E,A$N" },
    { 0xF1FC, 0x90F8, "SUBA.W $E,A$N" },
    { 0xF1FF, 0x90FC, "SUBA.W $E,A$N" },
    { 0xF1E0, 0x91C0, "SUBA.L $E,A$N" },
    { 0xF1F0, 0x91E0, "SUBA.L $E,A$N" },
    { 0xF1F8, 0x91F0, "SUBA.L $E,A$N" },
    { 0xF1FC, 0x91F8, "SUBA.L $E,A$N" },
    { 0xF1FF, 0x91FC, "SUBA.L $E,A$N" },
    { 0xF000, 0xA000, "ALINE Exception" },
    { 0xF1F8, 0xB000, "CMP.B $E,D$N" },
    { 0xF1F0, 0xB010, "CMP.B $E,D$N" },
    { 0xF1E0, 0xB040, "CMP.W $E,D$N" },
    { 0xF1B0, 0xB020, "CMP.@ $E,D$N" },
    { 0xF1B8, 0xB030, "CMP.@ $E,D$N" },
    { 0xF1BC, 0xB038, "CMP.@ $E,D$N" },
    { 0xF1BF, 0xB03C, "CMP.@ $E,D$N" },
    { 0xF1E0, 0xB080, "CMP.L $E,D$N" },
    { 0xF1F0, 0xB0A0, "CMP.L $E,D$N" },
    { 0xF1F8, 0xB0B0, "CMP.L $E,D$N" },
    { 0xF1FC, 0xB0B8, "CMP.L $E,D$N" },
    { 0xF1FF, 0xB0BC, "CMP.L $E,D$N" },
    { 0xF1E0, 0xB0C0, "CMPA.W $E,A$N" },
    { 0xF1F0, 0xB0E0, "CMPA.W $E,A$N" },
    { 0xF1F8, 0xB0F0, "CMPA.W $E,A$N" },
    { 0xF1FC, 0xB0F8, "CMPA.W $E,A$N" },
    { 0xF1FF, 0xB0FC, "CMPA.W $E,A$N" },
    { 0xF1E0, 0xB1C0, "CMPA.L $E,A$N" },
    { 0xF1F0, 0xB1E0, "CMPA.L $E,A$N" },
    { 0xF1F8, 0xB1F0, "CMPA.L $E,A$N" },
    { 0xF1FC, 0xB1F8, "CMPA.L $E,A$N" },
    { 0xF1FF, 0xB1FC, "CMPA.L $E,A$N" },
    { 0xF1F8, 0xB108, "CMPM.B (A$R)+,(A$N)+" },
    { 0xF1F8, 0xB148, "CMPM.W (A$R)+,(A$N)+" },
    { 0xF1F8, 0xB188, "CMPM.L (A$R)+,(A$N)+" },
    { 0xF1B8, 0xB100, "EOR.@ $E,D$N" },
    { 0xF1B0, 0xB110, "EOR.@ $E,D$N" },
    { 0xF1B0, 0xB120, "EOR.@ $E,D$N" },
    { 0xF1B8, 0xB130, "EOR.@ $E,D$N" },
    { 0xF1BE, 0xB138, "EOR.@ $E,D$N" },
    { 0xF1F8, 0xB180, "EOR.L D$N,$E" },
    { 0xF1F0, 0xB190, "EOR.L D$N,$E" },
    { 0xF1F0, 0xB1A0, "EOR.L D$N,$E" },
    { 0xF1F8, 0xB1B0, "EOR.L D$N,$E" },
    { 0xF1FE, 0xB1B8, "EOR.L D$N,$E" },
    { 0xF1B8, 0xC000, "AND.@ $E,D$N" },
    { 0xF1B0, 0xC010, "AND.@ $E,D$N" },
    { 0xF1B0, 0xC020, "AND.@ $E,D$N" },
    { 0xF1B8, 0xC030, "AND.@ $E,D$N" },
    { 0xF1BC, 0xC038, "AND.@ $E,D$N" },
    { 0xF1BF, 0xC03C, "AND.@ $E,D$N" },
    { 0xF1F8, 0xC048, "AND.W A$N,$E" },
    { 0xF1B0, 0xC110, "AND.@ D$N,$E" },
    { 0xF1B0, 0xC120, "AND.@ D$N,$E" },
    { 0xF1B8, 0xC130, "AND.@ D$N,$E" },
    { 0xF1BE, 0xC138, "AND.@ D$N,$E" },
    { 0xF1F8, 0xC080, "AND.L $E,D$N" },
    { 0xF1F8, 0xC088, "AND.L $E,D$N" },
    { 0xF1F0, 0xC090, "AND.L $E,D$N" },
    { 0xF1F0, 0xC0A0, "AND.L $E,D$N" },
    { 0xF1F8, 0xC0B0, "AND.L $E,D$N" },
    { 0xF1FC, 0xC0B8, "AND.L $E,D$N" },
    { 0xF1FF, 0xC0BC, "AND.L $E,D$N" },
    { 0xF1F0, 0xC190, "AND.L D$N,$E" },
    { 0xF1F0, 0xC1A0, "AND.L D$N,$E" },
    { 0xF1F8, 0xC1B0, "AND.L D$N,$E" },
    { 0xF1FE, 0xC1B8, "AND.L D$N,$E" },
    { 0xF1F8, 0xC0C0, "MULU $E,D$N" },
    { 0xF1F0, 0xC0D0, "MULU $E,D$N" },
    { 0xF1F0, 0xC0E0, "MULU $E,D$N" },
    { 0xF1F8, 0xC0F0, "MULU $E,D$N" },
    { 0xF1FC, 0xC0F8, "MULU $E,D$N" },
    { 0xF1FF, 0xC0FC, "MULU $E,D$N" },
    { 0xF1F8, 0xC1C0, "MULS $E,D$N" },
    { 0xF1F0, 0xC1D0, "MULS $E,D$N" },
    { 0xF1F0, 0xC1E0, "MULS $E,D$N" },
    { 0xF1F8, 0xC1F0, "MULS $E,D$N" },
    { 0xF1FC, 0xC1F8, "MULS $E,D$N" },
    { 0xF1FF, 0xC1FC, "MULS $E,D$N" },
    { 0xF1F8, 0xC100, "ABCD D$R, D$N" },
    { 0xF1F8, 0xC108, "ABCD -(A$R),-(A$N)" },
    { 0xF1F8, 0xC140, "EXG D$N,D$R" },
    { 0xF1F8, 0xC148, "EXG A$N,A$R" },
    { 0xF1F8, 0xC188, "EXG D$N,A$R" },
    { 0xF1B8, 0xD000, "ADD.@ $E,D$N" },
    { 0xF1B0, 0xD010, "ADD.@ $E,D$N" },
    { 0xF1B0, 0xD020, "ADD.@ $E,D$N" },
    { 0xF1B8, 0xD030, "ADD.@ $E,D$N" },
    { 0xF1BC, 0xD038, "ADD.@ $E,D$N" },
    { 0xF1BF, 0xD03C, "ADD.@ $E,D$N" },
    { 0xF1F8, 0xD048, "ADD.W A$N,$E" },
    { 0xF1B0, 0xD110, "ADD.@ D$N,$E" },
    { 0xF1B0, 0xD120, "ADD.@ D$N,$E" },
    { 0xF1B8, 0xD130, "ADD.@ D$N,$E" },
    { 0xF1BE, 0xD138, "ADD.@ D$N,$E" },
    { 0xF1F8, 0xD080, "ADD.L $E,D$N" },
    { 0xF1F8, 0xD088, "ADD.L $E,D$N" },
    { 0xF1F0, 0xD090, "ADD.L $E,D$N" },
    { 0xF1F0, 0xD0A0, "ADD.L $E,D$N" },
    { 0xF1F8, 0xD0B0, "ADD.L $E,D$N" },
    { 0xF1FC, 0xD0B8, "ADD.L $E,D$N" },
    { 0xF1FF, 0xD0BC, "ADD.L $E,D$N" },
    { 0xF1F0, 0xD190, "ADD.L D$N,$E" },
    { 0xF1F0, 0xD1A0, "ADD.L D$N,$E" },
    { 0xF1F8, 0xD1B0, "ADD.L D$N,$E" },
    { 0xF1FE, 0xD1B8, "ADD.L D$N,$E" },
    { 0xF1B8, 0xD100, "ADDX.@ D$R,D$N" },
    { 0xF1B8, 0xD108, "ADDX.@ -(A$R),-(A$N)" },
    { 0xF1F8, 0xD180, "ADDX.L D$R,D$N" },
    { 0xF1F8, 0xD188, "ADDX.L -(A$R),-(A$N)" },
    { 0xF1E0, 0xD0C0, "ADDA.W $E,A$N" },
    { 0xF1F0, 0xD0E0, "ADDA.W $E,A$N" },
    { 0xF1F8, 0xD0F0, "ADDA.W $E,A$N" },
    { 0xF1FC, 0xD0F8, "ADDA.W $E,A$N" },
    { 0xF1FF, 0xD0FC, "ADDA.W $E,A$N" },
    { 0xF1E0, 0xD1C0, "ADDA.L $E,A$N" },
    { 0xF1F0, 0xD1E0, "ADDA.L $E,A$N" },
    { 0xF1F8, 0xD1F0, "ADDA.L $E,A$N" },
    { 0xF1FC, 0xD1F8, "ADDA.L $E,A$N" },
    { 0xF1FF, 0xD1FC, "ADDA.L $E,A$N" },
    { 0xFEF0, 0xE0D0, "ASd $E  " },
    { 0xFEF0, 0xE0E0, "ASd $E  " },
    { 0xFEF8, 0xE0F0, "ASd $E  " },
    { 0xFEFE, 0xE0F8, "ASd $E  " },
    { 0xFEF0, 0xE2D0, "LSd $E  " },
    { 0xFEF0, 0xE2E0, "LSd $E  " },
    { 0xFEF8, 0xE2F0, "LSd $E  " },
    { 0xFEFE, 0xE2F8, "LSd $E  " },
    { 0xFEF0, 0xE4D0, "ROXd $E " },
    { 0xFEF0, 0xE4E0, "ROXd $E " },
    { 0xFEF8, 0xE4F0, "ROXd $E " },
    { 0xFEFE, 0xE4F8, "ROXd $E " },
    { 0xFEF0, 0xE6D0, "ROd $E  " },
    { 0xFEF0, 0xE6E0, "ROd $E  " },
    { 0xFEF8, 0xE6F0, "ROd $E  " },
    { 0xFEFE, 0xE6F8, "ROd $E  " },
    { 0xF0B8, 0xE000, "ASd.@ $N,D$R" },
    { 0xF0F8, 0xE080, "ASd.L $N,D$R" },
    { 0xF0B8, 0xE008, "LSd.@ $N,D$R" },
    { 0xF0F8, 0xE088, "LSd.L $N,D$R" },
    { 0xF0B8, 0xE010, "ROXd.@ $N,D$R" },
    { 0xF0F8, 0xE090, "ROXd.L $N,D$R" },
    { 0xF0B8, 0xE018, "ROd.@ $N,D$R" },
    { 0xF0F8, 0xE098, "ROd.L $N,D$R" },
    { 0xF0B8, 0xE020, "ASd.@ D$N,D$R" },
    { 0xF0F8, 0xE0A0, "ASd.L D$N,D$R" },
    { 0xF0B8, 0xE028, "LSd.@ D$N,D$R" },
    { 0xF0F8, 0xE0A8, "LSd.L D$N,D$R" },
    { 0xF0B8, 0xE030, "ROXd.@ D$N,D$R" },
    { 0xF0F8, 0xE0B0, "ROXd.L D$N,D$R" },
    { 0xF0B8, 0xE038, "ROd.@ D$N,D$R" },
    { 0xF0F8, 0xE0B8, "ROd.L D$N,D$R" },
    { 0xF000, 0xF000, "FLINE Exception" },
};

#define OPCODE_COUNT (sizeof(opcodes) / sizeof(opcode_t))

char *ea(uint16_t ea) {
	static char b1[32], b2[32], *buffer;
	if(buffer == b1) buffer = b2; else buffer = b1;

	switch(ea & 0x38) {
	case 0x00: sprintf( buffer, "D%d", ea & 7 ); break;
	case 0x08: sprintf( buffer, "A%d", ea & 7 ); break;
	case 0x10: sprintf( buffer, "(A%d)", ea & 7 ); break;
	case 0x18: sprintf( buffer, "(A%d)+", ea & 7 ); break;
	case 0x20: sprintf( buffer, "-(A%d)", ea & 7 ); break;
	case 0x28: sprintf( buffer, "d16(A%d)", ea & 7 ); break;
	case 0x30: sprintf( buffer, "d8(A%d,Xn)", ea & 7 ); break;
	case 0x38:
		switch(ea & 7) {
		case 0: sprintf(buffer, "ABS.W"); break;		
		case 1: sprintf(buffer, "ABS.L"); break;		
		case 2: sprintf(buffer, "d16(PC)"); break;		
		case 3: sprintf(buffer, "d8(PC,Xn)"); break;
		case 4: sprintf(buffer, "#Immd"); break;	
        default: return NULL;
		}
		break;
	} // end switch
	return buffer;
}

const char* m68k_disasm(uint16_t op) {
	static char buffer[64];
	static char buffer2[64];

    int i;
    for(i=0; i<OPCODE_COUNT; i++) {
        if((op & opcodes[i].match) == opcodes[i].equal)
            break;
    }
    if(i == OPCODE_COUNT) return "ILLEGAL";

    sprintf( buffer, "%s", opcodes[i].op );

    char* cnd = strstr(buffer, "cc");
    char* bwx = strstr(buffer, ".@");
    char* shf = strstr(buffer, "d.");
    char* ea1 = strstr(buffer, "$E");
    char* ea2 = ea1 ? strstr(ea1 + 1, "$E") : 0;
    char* imm = strstr(buffer, "$N");
    char* reg = strstr(buffer, "$R");
    
    int cnd_off = cnd - buffer;
    int bwx_off = bwx - buffer;
    int shf_off = shf - buffer;
    int ea1_off = ea1 - buffer;
    int ea2_off = ea2 - buffer;
    int imm_off = imm - buffer;
    int reg_off = reg - buffer;

    unsigned _i = (op >> 9) & 7;
    unsigned _r = (op & 7);
    
    if(cnd) buffer[cnd_off] = cc[(op >> 8) & 0xF][0], buffer[cnd_off + 1] = cc[(op >> 8) & 0xF][1];
    if(bwx) buffer[bwx_off + 1] = (op & 0x0040) ? 'W' : 'B';
    if(shf) buffer[shf_off] = (op & 0x0100) ? 'L' : 'R';
    if(ea1) buffer[ea1_off] = '%', buffer[ea1_off + 1] = 's';
    if(ea2) buffer[ea2_off] = '%', buffer[ea2_off + 1] = 's';
    if(imm) buffer[imm_off] = '%', buffer[imm_off + 1] = 'd';
    if(reg) buffer[reg_off] = '%', buffer[reg_off + 1] = 'd';
    
    if(ea1 && ea2) {
        char* _ea1 = ea(op & 0x3F);
        char* _ea2 = ea(((op >> 9) & 0x07) | ((op >> 3) & 0x38));
        sprintf(buffer2, buffer, _ea1, _ea2);
        
    } else if(ea1) {
        char* _ea = ea(op & 0x3F);
        if(imm && reg) {
            if (ea1 < imm) {
                if (imm < reg)      sprintf(buffer2, buffer, _ea,_i,_r);  // return [ea1,imm,reg];
                else if (ea1 < reg) sprintf(buffer2, buffer, _ea,_r,_i);  // return [ea1,reg,imm];
                else                sprintf(buffer2, buffer, _r,_ea,_i);  // return [reg,ea1,imm];
            } else {
                if (ea1 < reg)      sprintf(buffer2, buffer, _i,_ea,_r);  // return [imm,ea1,reg];
                else if (imm < reg) sprintf(buffer2, buffer, _i,_r,_ea);  // return [imm,reg,ea1];
                else                sprintf(buffer2, buffer, _r,_i,_ea);  // return [reg,imm,ea1];
            }
        } else if(imm) {
            if (ea1 < imm)          sprintf(buffer2, buffer, _ea,_i);     // return [reg,ea1,imm];
            else                    sprintf(buffer2, buffer, _i,_ea);     // return [reg,imm,ea1];
            
        } else if(reg) {
            if (ea1 < reg)          sprintf(buffer2, buffer, _ea,_r);     // return [reg,ea1,imm];
            else                    sprintf(buffer2, buffer, _r,_ea);     // return [reg,imm,ea1];
            
        } else                      sprintf(buffer2, buffer, _ea);        // return [reg,imm,ea1];
        
    } else {
        if(imm && reg) {
            if (imm < reg)          sprintf(buffer2, buffer, _i,_r);      // return [ea1,imm,reg];
            else                    sprintf(buffer2, buffer, _r,_i);      // return [reg,ea1,imm];
            
        } 
        else if(imm)                sprintf(buffer2, buffer, _i);         // return [reg,ea1,imm];
        else if(reg)                sprintf(buffer2, buffer, _r);         // return [reg,ea1,imm];
        else                        sprintf(buffer2, buffer);             // return [reg,imm,ea1];
        
    }
    return buffer2;

}







